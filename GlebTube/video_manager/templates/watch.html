{% extends 'index.html' %}

{% block title %} {{video.caption}} - GlebTube  {% endblock %}

{%block content %}

{% load formatted_markdown %}
{% load bleach_tags %}


{% load static %}
{% csrf_token %}

<!--Styles-->
<link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
<link rel="stylesheet" a href="{% static '/css/enchanced_player.css' %}"> 

<link rel="stylesheet" a href="{% static '/css/rate_buttons.css' %}"> 
<link rel="stylesheet" a href="{% static '/css/md_style.css' %}"> 
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

<div class="container mt-5">
  <div class="card mb-3 border-0">
    <video id="player" playsinline controls data-poster="{{video.img.url}}">
      <source src="{{video.video.url}}" type="video/mp4" />
      <source src="{{video.video.url}}" type="video/webm" />
    
      <!-- Captions are optional 
      <track kind="captions" label="English captions" src="/path/to/captions.vtt" srclang="en" default /> -->
    </video>
    <div class="card-body">
      <h5 class="card-title text-uppercase font-weight-bold">{{video.caption}}</h5>
      <h6 class="card-subtitle mb-2 text-muted">Описание</h6>
      <div class="md_content">
      <p class="card-text">{{video.description|formatted_markdown|bleach}}</p>
    </div>
      <p class="card-text">
        <i class="bi bi-star-fill"> Количество Звёзд: {{video.views}} </i>
        <i class="bi bi-binoculars-fill"> Количество просмотров: {{video.views}} </i></p>
      <p class="card-text"><i class="bi bi-clock-fill"> Дата выхода: {{video.date_uploaded|date:"m.d.Y"}}</i></p>
      <p class="card-text"><i class="bi bi-person-circle">  Автор:  <a href="/profile/{{video.author}}">{{video.author}} </i></a></p>
    </div>
  </div>
<div class="post float-right" data-post-id="{{video.id}}">
<div class = "rate_container">
  ...
</div>


<!-- COMMENT(s) -->
</div class="comment_form">
  <h3 id="comments_count"><i class="bi bi-chat-dots-fill">  Комментарии</i></h3>
  
  <div class="bg-white p-2">
    <div class="d-flex flex-row align-items-start">
        <img class="rounded-circle" src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Israeli_blue_Star_of_David.png" width="40">
        <textarea class="form-control ml-1 shadow-none textarea" id="comment" placeholder="Введите комментарий"></textarea>
    </div>
    <div class="mt-2 text-right">
        <button type="button" id="clearButton" class="btn btn-outline-primary btn-sm shadow-none"><i class="bi bi-trash"> Очистить</i></button>
        <button hx-post="/add_comment_video/{{video.id}}" hx-vars="comment:document.getElementById('comment').value" 
         hx-target=".comment_list"
         hx-swap="afterbegin"
         hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
         class="btn btn-primary btn-sm shadow-none" id="sendButton" type="button"><i class="bi bi-send"> Отправить</i></button>
    </div>
</div>

<div class="comment_list">
{% for comment in comments %}  
{% include 'comment.html' %}
{% endfor %} 
</div>
</div>
</div>

<!--Scripts-->

<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
<script src="{% static '/js/player.js' %}"></script>
<script src="{% static '/js/comment_video.js' %}"></script>
{% endblock %}